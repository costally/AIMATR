<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marathon AI Coach v3.4</title>
    <style>
        :root {
            --primary: #007AFF;
            --secondary: #5856D6;
            --success: #34C759;
            --warning: #FF9500;
            --danger: #FF3B30;
            --info: #64D2FF; 
            --steady: #AF52DE;
            --bg: #F2F2F7;
            --card: #FFFFFF;
            --text-main: #1c1c1e;
            --text-sub: #8e8e93;
            --info-bg: #EEF1F5;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background-color: var(--card);
            border-radius: 24px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            padding: 30px;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
            min-height: 950px;
        }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none !important; }

        header { text-align: center; margin-bottom: 25px; }
        .badge { background-color: #E5E5EA; color: var(--text-sub); padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; }
        h1 { margin: 10px 0 5px 0; font-size: 1.8rem; letter-spacing: -0.5px; }
        .subtitle { font-size: 0.95rem; color: var(--text-sub); margin: 0; }

        /* Form Styles */
        .form-section { margin-bottom: 25px; border-bottom: 1px solid #f2f2f7; padding-bottom: 20px; }
        .form-section:last-of-type { border-bottom: none; }
        .section-title { font-size: 0.9rem; font-weight: 600; color: var(--text-sub); margin-bottom: 10px; text-transform: uppercase; }
        .row { display: flex; gap: 15px; }
        .col { flex: 1; }
        label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; }
        select, input[type="date"] {
            width: 100%; padding: 14px; border: 1px solid #d1d1d6; border-radius: 12px; font-size: 1rem;
            background: #fff; box-sizing: border-box; -webkit-appearance: none;
        }
        select:focus, input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(0,122,255,0.1); }

        .time-picker-group { display: flex; gap: 5px; align-items: center; }
        .time-select-wrapper { flex: 1; position: relative; }
        .time-select-wrapper select { text-align: center; padding-right: 20px; }
        .time-label { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); font-size: 0.8rem; color: #8e8e93; pointer-events: none; }

        .preset-group { display: flex; gap: 8px; margin-bottom: 15px; }
        .preset-btn {
            flex: 1; padding: 12px 5px; border: 1px solid #d1d1d6; background: white; border-radius: 10px;
            font-size: 0.85rem; font-weight: 600; color: #666; cursor: pointer; transition: 0.2s; line-height: 1.3; position: relative;
        }
        .preset-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
        .preset-btn:hover:not(.active) { background: #f2f2f7; }
        .rec-badge {
            position: absolute; top: -10px; right: -5px; background: #FF3B30; color: white;
            font-size: 0.65rem; padding: 3px 8px; border-radius: 12px; display: none; font-weight: 800;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); border: 2px solid #fff;
            animation: bounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 10;
        }
        @keyframes bounceIn { 0% { transform: scale(0); opacity: 0; } 60% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); } }

        .feedback-box {
            background: #f2f2f7; padding: 15px; border-radius: 12px; margin-top: 10px;
            font-size: 0.9rem; display: flex; flex-direction: column; gap: 5px; border-left: 4px solid #ccc; transition: all 0.3s;
        }
        .feedback-box.safe { background: #e8fbf0; border-left-color: var(--success); color: #0c5122; }
        .feedback-box.challenge { background: #fff8e6; border-left-color: var(--warning); color: #7a4f01; }
        .feedback-box.danger { background: #feebeb; border-left-color: var(--danger); color: #c90a00; }
        .rec-time-display { font-size: 1.1rem; font-weight: 800; color: var(--primary); margin-top: 5px; }

        .science-info {
            background-color: var(--info-bg); padding: 15px; border-radius: 12px; margin-top: 15px;
            font-size: 0.8rem; color: #555; line-height: 1.5; border: 1px solid #E1E4E8;
        }
        .science-info strong { color: #333; font-weight: 700; }
        .science-info ul { margin: 5px 0 0 0; padding-left: 20px; }
        .science-info li { margin-bottom: 4px; }

        button.cta {
            width: 100%; background-color: var(--primary); color: white; padding: 16px; border: none; border-radius: 16px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 12px rgba(0,122,255,0.3);
            margin-top: 10px;
        }
        button.cta:hover { background-color: #0062cc; transform: translateY(-2px); }
        button.secondary-btn {
            width: 100%; background-color: transparent; color: #8e8e93; padding: 12px; border: none; font-weight: 600;
            cursor: pointer; margin-top: 10px;
        }

        /* --- View 2 Styles --- */
        .summary-card { background: #F2F2F7; padding: 25px; border-radius: 20px; text-align: center; margin-bottom: 25px; }
        .big-stat { font-size: 2.5rem; font-weight: 800; color: var(--primary); display: block; margin-bottom: 5px; }
        .sub-stat { font-size: 1rem; color: #666; }
        .summary-info-row { display: flex; justify-content: center; gap: 15px; margin-top: 15px; color: #666; font-size: 0.9rem; }
        
        .pace-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 30px; }
        .pace-card { background: white; padding: 15px; border-radius: 12px; border: 1px solid #e5e5ea; position: relative; }
        .pace-label { font-size: 0.8rem; color: #8e8e93; font-weight: 700; margin-bottom: 5px; display: flex; align-items: center; gap: 5px; }
        .pace-value { font-size: 1.1rem; font-weight: 700; color: #1c1c1e; }
        .dot { width: 8px; height: 8px; border-radius: 50%; }

        .guide-list { margin-top: 30px; margin-bottom: 30px; }
        .guide-item { margin-bottom: 15px; background: white; border: 1px solid #E5E5EA; border-radius: 12px; padding: 15px; }
        .guide-header { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        .guide-title { font-weight: 800; font-size: 1rem; color: #333; }
        .guide-desc { font-size: 0.9rem; color: #555; line-height: 1.5; }
        .guide-tag { font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; background: #F2F2F7; color: #666; font-weight: 600; margin-left: auto; }

        /* --- View 3 & 4 Styles --- */
        .timeline-container { position: relative; padding-left: 20px; border-left: 2px solid #e5e5ea; margin-left: 10px; }
        .phase-card { margin-bottom: 20px; padding: 20px; border-radius: 16px; color: white; position: relative; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .phase-base { background: linear-gradient(135deg, #34C759, #248A3D); }
        .phase-build { background: linear-gradient(135deg, #FF9500, #CC7700); }
        .phase-peak { background: linear-gradient(135deg, #FF3B30, #C41C00); }
        .phase-taper { background: linear-gradient(135deg, #007AFF, #0055B3); }
        .phase-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .phase-name { font-size: 1.1rem; font-weight: 800; }
        .phase-weeks { background: rgba(255,255,255,0.25); padding: 2px 8px; border-radius: 8px; font-size: 0.8rem; font-weight: 600; }
        .phase-desc { font-size: 0.9rem; opacity: 0.95; line-height: 1.4; }

        /* Week Navigation */
        .week-nav {
            display: flex; justify-content: space-between; align-items: center;
            background: #F2F2F7; border-radius: 16px; padding: 15px 20px; margin-bottom: 25px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.03);
        }
        .nav-btn {
            background: white; border: 1px solid #d1d1d6; width: 40px; height: 40px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center; cursor: pointer; font-size: 1.2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: 0.2s; color: var(--primary);
        }
        .nav-btn:hover { background: var(--primary); color: white; transform: scale(1.05); }
        .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; background: #eee; color: #999; transform: none; }
        
        .week-info { text-align: center; }
        .week-title { font-size: 1.3rem; font-weight: 800; display: block; margin-bottom: 4px; }
        .week-phase { font-size: 0.85rem; color: #666; font-weight: 600; background: rgba(0,0,0,0.05); padding: 4px 10px; border-radius: 12px; }

        /* Daily Cards */
        .daily-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .day-card {
            background: white; border: 1px solid #E5E5EA; border-radius: 16px; padding: 20px 15px;
            position: relative; transition: all 0.2s; cursor: pointer; overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }
        /* Color coded top borders */
        .day-card.type-Rest { border-top: 5px solid #8e8e93; }
        .day-card.type-Easy { border-top: 5px solid var(--success); }
        .day-card.type-Speed { border-top: 5px solid var(--danger); }
        .day-card.type-Long { border-top: 5px solid var(--warning); }
        .day-card.type-Medium { border-top: 5px solid var(--steady); }
        .day-card.type-Recovery { border-top: 5px solid var(--info); }

        .day-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); }
        /* [Active State] í›¨ì”¬ ë” ê°•ë ¥í•œ ì‹œê°ì  íš¨ê³¼ */
        .day-card.active {
            border: 3px solid var(--primary);
            background-color: #F0F7FF;
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 24px rgba(0,122,255,0.25);
            z-index: 10;
        }
        .day-card.today { background-color: #F8FBFF; }
        .day-card.today::after { content: 'TODAY'; position: absolute; top: 10px; right: 10px; background: #1c1c1e; color: white; font-size: 0.6rem; padding: 2px 6px; border-radius: 8px; font-weight: 700; }
        
        .day-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .day-date { font-size: 0.85rem; color: #8e8e93; font-weight: 600; }
        .day-badge { font-size: 0.65rem; font-weight: 700; padding: 2px 6px; border-radius: 4px; background: #eee; color: #555; }
        .today .day-badge { background: var(--primary); color: white; }

        .day-icon { font-size: 2rem; display: block; margin-bottom: 10px; text-align: center; }
        .day-title { font-size: 1.1rem; font-weight: 800; color: #1c1c1e; margin-bottom: 5px; text-align: center; letter-spacing: -0.5px; }
        .day-desc { font-size: 0.85rem; color: #555; text-align: center; line-height: 1.4; height: 36px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        .detail-box { background: white; border: 1px solid #E5E5EA; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .detail-header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; }
        .detail-icon-box { width: 50px; height: 50px; background: #FFF4E5; border-radius: 12px; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; }
        .detail-title-group h3 { margin: 0; font-size: 1.3rem; }
        .detail-title-group span { font-size: 0.9rem; color: #666; }
        /* Detail Grid: Changed to single column for detailed text */
        .detail-content { display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px; }
        .info-block { background: #F9F9F9; padding: 20px; border-radius: 12px; border-left: 4px solid var(--primary); }
        .info-label { font-size: 0.9rem; font-weight: 800; color: var(--primary); margin-bottom: 8px; display: block; text-transform: uppercase; letter-spacing: 0.5px; }
        .info-text { font-size: 0.95rem; color: #333; line-height: 1.6; }
        .info-text ul { margin: 5px 0 0 0; padding-left: 20px; }
        .info-text li { margin-bottom: 5px; }

        .caution-box { background: #FFF5F5; border-left: 4px solid var(--danger); padding: 15px; border-radius: 8px; }
        .caution-label { color: var(--danger); font-weight: 700; font-size: 0.8rem; margin-bottom: 3px; display: block; }

    </style>
</head>
<body>

    <div class="container">
        <!-- HEADER -->
        <header>
            <span class="badge">AI COACH v3.4</span>
            <h1>Marathon Planner</h1>
            <p class="subtitle" id="pageSubtitle">ë‚˜ë§Œì˜ ë§ì¶¤í˜• í›ˆë ¨ í”„ë¡œê·¸ë¨ ì„¤ì •</p>
        </header>

        <!-- [VIEW 1] ì…ë ¥ í™”ë©´ -->
        <div id="view-home" class="fade-in">
            <form id="runnerForm">
                <!-- 1. ê¸°ëŸ‰ ì •ë³´ -->
                <div class="form-section">
                    <div class="section-title">1. Current Fitness (í˜„ì¬ ê¸°ëŸ‰)</div>
                    <div class="row">
                        <div class="col" style="flex: 0.8;">
                            <label>ìµœê·¼ ë‹¬ë¦° ê±°ë¦¬</label>
                            <select id="currentDist" onchange="updateAll()">
                                <option value="5">5km</option>
                                <option value="10" selected>10km</option>
                                <option value="21.0975">í•˜í”„</option>
                                <option value="42.195">í’€ì½”ìŠ¤</option>
                            </select>
                        </div>
                        <div class="col" style="flex: 1.2;">
                            <label>ìµœê·¼ ê¸°ë¡</label>
                            <div class="time-picker-group">
                                <div class="time-select-wrapper"><select id="curH" onchange="updateAll()"></select><span class="time-label">h</span></div>
                                <div class="time-select-wrapper"><select id="curM" onchange="updateAll()"></select><span class="time-label">m</span></div>
                                <div class="time-select-wrapper"><select id="curS" onchange="updateAll()"></select><span class="time-label">s</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="section-title">2. Target Goal (ëª©í‘œ ì„¤ì •)</div>
                    <div class="row" style="margin-bottom:10px;">
                        <div class="col" style="flex:0.8;">
                            <label>ëª©í‘œ ëŒ€íšŒ</label>
                            <select id="targetDist" onchange="updateAll()">
                                <option value="5">5K</option>
                                <option value="10">10K</option>
                                <option value="21.0975">í•˜í”„</option>
                                <option value="42.195" selected>í’€ì½”ìŠ¤</option>
                            </select>
                        </div>
                        <div class="col" style="flex:1.2;">
                            <label>ëª©í‘œ ê¸°ë¡ ì„¤ì •</label>
                            <div class="time-picker-group">
                                <div class="time-select-wrapper"><select id="tarH" onchange="updateAll()"></select><span class="time-label">h</span></div>
                                <div class="time-select-wrapper"><select id="tarM" onchange="updateAll()"></select><span class="time-label">m</span></div>
                                <div class="time-select-wrapper"><select id="tarS" onchange="updateAll()"></select><span class="time-label">s</span></div>
                            </div>
                        </div>
                    </div>
                    <label style="margin-top:20px;">í›ˆë ¨ ê¸°ê°„ ì„ íƒ</label>
                    <div class="preset-group">
                        <button type="button" class="preset-btn" id="btn8" onclick="selectPreset(8, this)">8ì£¼<br>(ë‹¨ê¸°)<span class="rec-badge">ì¶”ì²œ</span></button>
                        <button type="button" class="preset-btn active" id="btn12" onclick="selectPreset(12, this)">12ì£¼<br>(í‘œì¤€)<span class="rec-badge">ì¶”ì²œ</span></button>
                        <button type="button" class="preset-btn" id="btn16" onclick="selectPreset(16, this)">16ì£¼<br>(ì‹¬í™”)<span class="rec-badge">ì¶”ì²œ</span></button>
                        <button type="button" class="preset-btn" id="btnAuto" onclick="selectPreset('auto', this)">ëŒ€íšŒì¼ê¹Œì§€<br>(Auto)</button>
                    </div>
                    <div class="row" style="margin-bottom: 20px;"><div class="col"><label>ëŒ€íšŒ ë‚ ì§œ</label><input type="date" id="raceDate" onchange="enableCustomMode()"></div></div>
                    <div id="goalFeedback" class="feedback-box"><span>ğŸ¯ ê¸°ë¡ì„ ì…ë ¥í•˜ë©´ AIê°€ ë¶„ì„í•´ë“œë¦½ë‹ˆë‹¤.</span></div>
                </div>
                <div class="form-section">
                    <div class="section-title">3. Schedule (í›ˆë ¨ ë¹ˆë„)</div>
                    <select id="freq" onchange="updateAll()">
                        <option value="3">ì£¼ 3íšŒ (ìœ ì§€/ê±´ê°•)</option>
                        <option value="4" selected>ì£¼ 4íšŒ (ê¸°ë¡í–¥ìƒ ê¶Œì¥)</option>
                        <option value="5">ì£¼ 5íšŒ (ì—˜ë¦¬íŠ¸/Sub-3)</option>
                    </select>
                </div>
                <button type="button" class="cta" onclick="generateAndGoToSummary()">í”„ë¡œê·¸ë¨ ìƒì„±í•˜ê¸°</button>
            </form>
        </div>

        <!-- [VIEW 2] ìš”ì•½ í™”ë©´ -->
        <div id="view-summary" class="hidden">
            <div class="summary-card">
                <span class="sub-stat" id="sumTitle">ëª©í‘œ ì„¤ì • ê¸°ë¡</span>
                <span class="big-stat" id="sumTargetTime">00:00:00</span>
                <div class="summary-info-row">
                    <span><span class="badge" style="background:var(--primary); color:white;">VDOT <span id="sumVdot">00</span></span></span>
                    <span>í›ˆë ¨ê¸°ê°„: <b style="color:#333" id="sumWeeks">00ì£¼</b></span>
                    <span>ëŒ€íšŒê¹Œì§€: <b style="color:#333" id="sumDday">D-00</b></span>
                </div>
            </div>
            <h4 class="section-title">ğŸƒ Training Paces (í›ˆë ¨ ëª©í‘œ í˜ì´ìŠ¤)</h4>
            <div class="pace-grid">
                <div class="pace-card"><div class="pace-label"><div class="dot" style="background:#64D2FF"></div>Recovery</div><div class="pace-value" id="paceRecovery">-</div></div>
                <div class="pace-card"><div class="pace-label"><div class="dot" style="background:var(--success)"></div>Easy / LSD</div><div class="pace-value" id="paceEasy">-</div></div>
                <div class="pace-card"><div class="pace-label"><div class="dot" style="background:#AF52DE"></div>Steady (ì§€ì†ì£¼)</div><div class="pace-value" id="paceSteady">-</div></div>
                <div class="pace-card"><div class="pace-label"><div class="dot" style="background:var(--primary)"></div>Marathon Pace</div><div class="pace-value" id="paceMarathon">-</div></div>
                <div class="pace-card"><div class="pace-label"><div class="dot" style="background:var(--warning)"></div>Threshold (T)</div><div class="pace-value" id="paceThreshold">-</div></div>
                <div class="pace-card"><div class="pace-label"><div class="dot" style="background:var(--danger)"></div>Interval (I)</div><div class="pace-value" id="paceInterval">-</div></div>
            </div>
            <h4 class="section-title">ğŸ“š Training Guide (í›ˆë ¨ ë°©ë²•)</h4>
            <div class="guide-list">
                <div class="guide-item"><div class="guide-header"><span style="font-size:1.2rem;">ğŸ©¹</span><span class="guide-title">Recovery (íšŒë³µì£¼)</span><span class="guide-tag">Zone 1</span></div><div class="guide-desc">ê³ ê°•ë„ í›ˆë ¨ ë‹¤ìŒ ë‚ , ëª¸ì— ìŒ“ì¸ í”¼ë¡œë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ <strong>ì•„ì£¼ ì²œì²œíˆ</strong> ë‹¬ë¦½ë‹ˆë‹¤.</div></div>
                <div class="guide-item"><div class="guide-header"><span style="font-size:1.2rem;">ğŸƒâ€â™‚ï¸</span><span class="guide-title">Easy Run (ì¡°ê¹…)</span><span class="guide-tag">Zone 2</span></div><div class="guide-desc">ëŒ€í™”ê°€ ê°€ëŠ¥í•œ í¸ì•ˆí•œ ì†ë„ì…ë‹ˆë‹¤. LSDëŠ” ì´ ì†ë„ë¡œ <strong>ì˜¤ë˜, ë©€ë¦¬</strong> ë‹¬ë¦¬ëŠ” í›ˆë ¨ì…ë‹ˆë‹¤.</div></div>
                <div class="guide-item"><div class="guide-header"><span style="font-size:1.2rem;">ğŸ</span><span class="guide-title">Steady Run (ì§€ì†ì£¼)</span><span class="guide-tag">Zone 3</span></div><div class="guide-desc">ì¡°ê¹…ë³´ë‹¤ ë¹ ë¥´ê³  ëŒ€íšŒ í˜ì´ìŠ¤ë³´ë‹¤ ëŠë¦°, <strong>ê¸°ë¶„ ì¢‹ì€ ë¬µì§í•¨</strong>ì„ ìœ ì§€í•˜ë©° ë‹¬ë¦½ë‹ˆë‹¤.</div></div>
                <div class="guide-item"><div class="guide-header"><span style="font-size:1.2rem;">ğŸ”¥</span><span class="guide-title">Threshold (ì—­ì¹˜ì£¼)</span><span class="guide-tag">Zone 4</span></div><div class="guide-desc"><strong>"í¸ì•ˆí•˜ê²Œ í˜ë“¤ë‹¤"</strong>ëŠ” ê°•ë„ì…ë‹ˆë‹¤. ì –ì‚° ì—­ì¹˜ë¥¼ ë†’ì—¬ ì§€ì¹˜ì§€ ì•ŠëŠ” ì†ë„ë¥¼ ê¸°ë¦…ë‹ˆë‹¤.</div></div>
                <div class="guide-item"><div class="guide-header"><span style="font-size:1.2rem;">âš¡</span><span class="guide-title">Interval (ì¸í„°ë²Œ)</span><span class="guide-tag">Zone 5</span></div><div class="guide-desc">ì§ˆì£¼ì™€ íœ´ì‹ì„ ë°˜ë³µí•˜ì—¬ <strong>ìµœëŒ€ ì‚°ì†Œ ì„­ì·¨ëŸ‰(VO2max)</strong>ì„ í™•ì¥ì‹œí‚¤ëŠ” ê³ ê°•ë„ í›ˆë ¨ì…ë‹ˆë‹¤.</div></div>
            </div>
            <button type="button" class="cta" onclick="goToDetail()">ìƒì„¸ í›ˆë ¨ ë¡œë“œë§µ ë³´ê¸°</button>
            <button type="button" class="secondary-btn" onclick="goToHome()">ì¡°ê±´ ë‹¤ì‹œ ì„¤ì •í•˜ê¸°</button>
        </div>

        <!-- [VIEW 3] Roadmap í™”ë©´ -->
        <div id="view-detail" class="hidden">
            <div style="margin-bottom:20px;">
                <h3 style="margin:0;">ğŸ“… ì£¼ì°¨ë³„ í›ˆë ¨ ë¡œë“œë§µ</h3>
                <p style="color:#666; font-size:0.9rem;">ì´ <span id="detailTotalWeeks">0</span>ì£¼ / <span id="detailTarget"></span> ëª©í‘œ</p>
            </div>
            <div class="timeline-container" id="timelineArea"></div>
            <button type="button" class="cta" style="margin-top:20px;" onclick="goToSchedule()">ğŸ“† ì¼ìë³„ ìƒì„¸ ìŠ¤ì¼€ì¤„ ë³´ê¸°</button>
            <button type="button" class="secondary-btn" onclick="goToSummary()">â† ìš”ì•½ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
        </div>

        <!-- [VIEW 4] Daily Schedule í™”ë©´ (NEW UI) -->
        <div id="view-schedule" class="hidden">
            <h3 style="margin:0 0 15px 0;">ğŸ—“ï¸ ì£¼ê°„ í›ˆë ¨ ìŠ¤ì¼€ì¤„</h3>
            <p style="color:#666; font-size:0.9rem; margin-bottom:20px;">ì¹´ë“œë¥¼ í´ë¦­í•˜ë©´ ìƒì„¸ í›ˆë ¨ ë£¨í‹´(ì›Œë°ì—…-ë³¸ìš´ë™-ì¿¨ë‹¤ìš´)ì´ ë‚˜ì˜µë‹ˆë‹¤.</p>

            <!-- Improved Week Navigation -->
            <div class="week-nav">
                <button class="nav-btn" onclick="changeWeek(-1)">â®</button>
                <div class="week-info">
                    <span class="week-title" id="displayWeek">Week 1</span>
                    <span class="week-phase" id="displayPhase">Base Phase</span>
                </div>
                <button class="nav-btn" onclick="changeWeek(1)">â¯</button>
            </div>

            <!-- Daily Cards -->
            <div class="daily-grid" id="dailyGrid"></div>

            <!-- Detail Box (Refined) -->
            <div id="detailBox" class="detail-box" style="display:none;">
                <div class="detail-header"><div class="detail-icon-box" id="dIcon"></div><div class="detail-title-group"><h3 id="dTitle"></h3><span id="dSubtitle"></span></div></div>
                
                <div class="detail-content">
                    <div class="info-block">
                        <span class="info-label">ğŸ¯ WHY (ì˜¤ëŠ˜ì˜ ëª©í‘œ)</span>
                        <div class="info-text" id="dWhy"></div>
                    </div>
                    <div class="info-block">
                        <span class="info-label">âš™ï¸ HOW (ìƒì„¸ í›ˆë ¨ ë£¨í‹´)</span>
                        <div class="info-text" id="dHow"></div>
                    </div>
                </div>
                
                <div class="caution-box"><span class="caution-label">âš ï¸ CAUTION (ì£¼ì˜ì‚¬í•­)</span><span id="dCaution"></span></div>
            </div>
            <button type="button" class="secondary-btn" style="margin-top:30px;" onclick="goToDetail()">â† ë¡œë“œë§µìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentTrainingWeeks = 12; 
        let userPaces = {}; 
        let userFreq = 4;   
        let globalTargetDist = 42.195;
        let currentViewWeek = 1;

        window.onload = function() {
            initTimeSelects();
            selectPreset(12, document.getElementById('btn12'));
            updateAll(); 
        }

        // ... (Existing Functions: initTimeSelects, updateAll, getInputs, calculateRecommendation, updateRecommendationBadge, updateFeedbackBox, selectPreset, enableCustomMode, formatPace, secondsToTime) ...
        function initTimeSelects() {
            const createOpts = (el, max) => { for(let i=0; i<=max; i++) el.add(new Option(i, i)); };
            createOpts(document.getElementById('curH'), 9); createOpts(document.getElementById('curM'), 59); createOpts(document.getElementById('curS'), 59);
            document.getElementById('curM').value = 37;
            createOpts(document.getElementById('tarH'), 9); createOpts(document.getElementById('tarM'), 59); createOpts(document.getElementById('tarS'), 59);
        }
        function updateAll() {
            const inputs = getInputs(); if(!inputs) return;
            const recommendation = calculateRecommendation(inputs);
            updateRecommendationBadge(recommendation);
            updateFeedbackBox(inputs);
        }
        function getInputs() {
            const curDist = parseFloat(document.getElementById('currentDist').value);
            const curH = parseInt(document.getElementById('curH').value)||0, curM = parseInt(document.getElementById('curM').value)||0, curS = parseInt(document.getElementById('curS').value)||0;
            const curSec = (curH*3600)+(curM*60)+curS;
            const targetDist = parseFloat(document.getElementById('targetDist').value);
            const tarH = parseInt(document.getElementById('tarH').value)||0, tarM = parseInt(document.getElementById('tarM').value)||0, tarS = parseInt(document.getElementById('tarS').value)||0;
            const targetSec = (tarH*3600)+(tarM*60)+tarS;
            const freq = parseInt(document.getElementById('freq').value)||4;
            if(curSec===0) return null;
            return { curDist, curSec, targetDist, targetSec, freq };
        }
        function calculateRecommendation(data) {
            const eqSec = data.curSec * Math.pow((data.targetDist / data.curDist), 1.06);
            let fM = (data.freq===3)?0.8:(data.freq===5?1.2:1.0);
            const pred = (w) => eqSec * (1 - (w * 0.0025 * fM));
            if(data.targetSec===0) return 12;
            if(pred(8) <= data.targetSec * 1.01) return 8; if(pred(12) <= data.targetSec * 1.01) return 12; return 16;
        }
        function updateRecommendationBadge(recWeeks) {
            document.querySelectorAll('.rec-badge').forEach(b => b.style.display='none');
            let btnId = recWeeks===8?"btn8":(recWeeks===12?"btn12":"btn16");
            const btn = document.getElementById(btnId); if(btn) { btn.querySelector('.rec-badge').style.display='inline-block'; btn.querySelector('.rec-badge').innerText="AI ì¶”ì²œ"; }
        }
        function updateFeedbackBox(data) {
            const eqSec = data.curSec * Math.pow((data.targetDist / data.curDist), 1.06);
            let fM = (data.freq===3)?0.8:(data.freq===5?1.2:1.0);
            const pSec = eqSec * (1 - (currentTrainingWeeks * 0.0025 * fM));
            const ph=Math.floor(pSec/3600), pm=Math.floor((pSec%3600)/60), ps=Math.floor(pSec%60);
            const recStr = (ph>0?`${ph}ì‹œê°„ `:"") + `${pm}ë¶„ ${ps}ì´ˆ`;
            const box = document.getElementById('goalFeedback');
            if(data.targetSec===0) { box.className="feedback-box"; box.innerHTML=`<span>ğŸ¤– ì„ íƒí•œ <strong>${currentTrainingWeeks}ì£¼</strong> í›ˆë ¨ ì‹œ ì˜ˆìƒ:</span><div class="rec-time-display">${recStr}</div>`; return; }
            const diff = (pSec - data.targetSec)/pSec;
            let msg="", cls="feedback-box";
            if(diff<=-0.02){msg="ğŸ‘ ì¶©ë¶„í•©ë‹ˆë‹¤.";cls+=" safe";} else if(diff<=0.015){msg="ğŸ‘Œ ì ì ˆí•©ë‹ˆë‹¤.";cls+=" safe";} else if(diff<=0.05){msg="ğŸ”¥ ë„ì „ì ì…ë‹ˆë‹¤.";cls+=" challenge";} else{msg="âš ï¸ ì–´ë µìŠµë‹ˆë‹¤.";cls+=" danger";}
            box.className=cls; box.innerHTML=`<span>${msg}</span><div style="font-size:0.85rem; color:#555; margin-top:5px; border-top:1px solid rgba(0,0,0,0.1); padding-top:5px;">AI ì˜ˆìƒ: <strong>${recStr}</strong></div>`;
        }
        function selectPreset(w, b) {
            document.querySelectorAll('.preset-btn').forEach(btn=>btn.classList.remove('active')); if(b) b.classList.add('active');
            if(w==='auto'){
                const v=document.getElementById('raceDate').value;
                if(!v){const d=new Date();d.setMonth(d.getMonth()+3);document.getElementById('raceDate').valueAsDate=d;currentTrainingWeeks=12;}
                else{const diff=Math.ceil((new Date(v)-new Date())/(86400000));currentTrainingWeeks=Math.floor(diff/7);}
            }else{currentTrainingWeeks=w; const d=new Date();d.setDate(d.getDate()+(w*7));document.getElementById('raceDate').valueAsDate=d;}
            updateAll();
        }
        function enableCustomMode() {
            document.querySelectorAll('.preset-btn').forEach(b=>b.classList.remove('active')); document.getElementById('btnAuto').classList.add('active');
            const v=document.getElementById('raceDate').value; if(v){const diff=Math.ceil((new Date(v)-new Date())/86400000);currentTrainingWeeks=Math.max(1,Math.floor(diff/7));updateAll();}
        }
        function formatPace(sec) { const m=Math.floor(sec/60), s=Math.floor(sec%60); return `${m}'${s.toString().padStart(2,'0')}"`; }
        function secondsToTime(sec) { const h=Math.floor(sec/3600), m=Math.floor((sec%3600)/60), s=Math.floor(sec%60); return (h>0?h+":":"")+m.toString().padStart(2,'0')+":"+s.toString().padStart(2,'0'); }

        // --- Navigation ---
        function switchView(id) {
            ['view-home','view-summary','view-detail','view-schedule'].forEach(v=>{document.getElementById(v).classList.add('hidden');document.getElementById(v).classList.remove('fade-in');});
            document.getElementById(id).classList.remove('hidden'); document.getElementById(id).classList.add('fade-in');
            const sub = document.getElementById('pageSubtitle');
            if(id==='view-home') sub.innerText="ë‚˜ë§Œì˜ ë§ì¶¤í˜• í›ˆë ¨ í”„ë¡œê·¸ë¨ ì„¤ì •";
            else if(id==='view-summary') sub.innerText="ê³¼í•™ì  ë°ì´í„° ë¶„ì„ ê²°ê³¼";
            else if(id==='view-detail') sub.innerText="ë‹¨ê³„ë³„ í›ˆë ¨ ìŠ¤ì¼€ì¤„";
            else sub.innerText="ì¼ìë³„ ìƒì„¸ í›ˆë ¨ ê°€ì´ë“œ";
            window.scrollTo(0,0);
        }
        function goToHome(){switchView('view-home');} function goToSummary(){switchView('view-summary');} function goToDetail(){switchView('view-detail');} 
        function goToSchedule(){
            currentViewWeek = 1; // Reset to Week 1
            switchView('view-schedule'); 
            renderScheduleUI(); 
        }

        function generateAndGoToSummary() {
            let inputs = getInputs();
            if(!inputs) { alert("ì…ë ¥ì„ í™•ì¸í•˜ì„¸ìš”."); return; }
            if(inputs.targetSec === 0) {
                const eqSec = inputs.curSec * Math.pow((inputs.targetDist / inputs.curDist), 1.06);
                let fM = (inputs.freq===3)?0.8:(inputs.freq===5?1.2:1.0);
                inputs.targetSec = Math.floor(eqSec * (1 - (currentTrainingWeeks * 0.0025 * fM)));
                const h=Math.floor(inputs.targetSec/3600), m=Math.floor((inputs.targetSec%3600)/60), s=Math.floor(inputs.targetSec%60);
                document.getElementById('tarH').value=h; document.getElementById('tarM').value=m; document.getElementById('tarS').value=s;
                alert(`ëª©í‘œ ê¸°ë¡ ìë™ ì„¤ì •: ${h}ì‹œê°„ ${m}ë¶„ ${s}ì´ˆ`);
            }

            const diffDays = Math.ceil((new Date(document.getElementById('raceDate').value) - new Date()) / 86400000);
            if(diffDays <= 0) { alert("ë‚ ì§œ ì˜¤ë¥˜"); return; }
            const totalWeeks = Math.floor(diffDays / 7);
            userFreq = inputs.freq;
            globalTargetDist = inputs.targetDist;

            const mpSec = inputs.targetSec / inputs.targetDist; 
            
            userPaces = {
                recovery: formatPace(mpSec * 1.35),
                easy: formatPace(mpSec * 1.25), 
                steady: formatPace(mpSec * 1.10), 
                marathon: formatPace(mpSec),
                threshold: formatPace(mpSec * 0.93),
                interval: formatPace(mpSec * 0.88)
            };

            const equiv10k = inputs.targetSec * Math.pow((10/inputs.targetDist), 1.06);
            const vdot = (1000 / (equiv10k/60) * 2.5).toFixed(1);
            let tLabel = inputs.targetDist===5?"5K":inputs.targetDist===10?"10K":inputs.targetDist===21.0975?"Half":"Full";

            document.getElementById('sumTitle').innerText = `${tLabel} ëª©í‘œ`;
            document.getElementById('sumTargetTime').innerText = secondsToTime(inputs.targetSec);
            document.getElementById('sumVdot').innerText = vdot;
            document.getElementById('sumWeeks').innerText = `${totalWeeks}ì£¼`;
            document.getElementById('sumDday').innerText = `D-${diffDays}`;
            
            document.getElementById('paceRecovery').innerText = userPaces.recovery + "/km";
            document.getElementById('paceEasy').innerText = userPaces.easy + "/km";
            document.getElementById('paceSteady').innerText = userPaces.steady + "/km";
            document.getElementById('paceMarathon').innerText = userPaces.marathon + "/km";
            document.getElementById('paceThreshold').innerText = userPaces.threshold + "/km";
            document.getElementById('paceInterval').innerText = userPaces.interval + "/km";

            renderTimeline(totalWeeks, inputs.freq, inputs.targetDist);
            document.getElementById('detailTotalWeeks').innerText = totalWeeks;
            document.getElementById('detailTarget').innerText = tLabel;

            goToSummary();
        }

        // ... (renderTimeline same as before) ...
        function renderTimeline(weeks, freq, targetDist) {
            const container = document.getElementById('timelineArea');
            container.innerHTML = "";
            let taper=2, peak=Math.max(2, Math.floor(weeks*0.25)), build=Math.max(3, Math.floor(weeks*0.35)), base=weeks-(taper+peak+build);
            if(base<1){base=1; build=weeks-(taper+peak+base);}
            
            const addCard = (type,name,dur,desc) => container.innerHTML += `<div class="phase-card ${type}"><div class="phase-header"><span class="phase-name">${name}</span><span class="phase-weeks">${dur}ì£¼ê°„</span></div><div class="phase-desc">${desc}</div></div>`;
            addCard('phase-base','1. Base',base,'ê¸°ì´ˆ ì²´ë ¥ ë° ìœ ì‚°ì†Œ ë² ì´ìŠ¤ êµ¬ì¶•');
            addCard('phase-build','2. Build',build,'ë§ˆì¼ë¦¬ì§€ ì¦ê°€ ë° ì—­ì¹˜ í›ˆë ¨');
            addCard('phase-peak','3. Peak',peak,'ìµœëŒ€ ê°•ë„, ì‹¤ì „ í˜ì´ìŠ¤ ì ì‘');
            addCard('phase-taper','4. Taper',taper,'í›ˆë ¨ëŸ‰ ê°ì†Œ ë° ì»¨ë””ì…˜ ì¡°ì ˆ');
        }

        /* --- [NEW] Daily Schedule UI Logic --- */
        function changeWeek(delta) {
            const next = currentViewWeek + delta;
            if(next < 1 || next > currentTrainingWeeks) return;
            currentViewWeek = next;
            renderScheduleUI();
        }

        function renderScheduleUI() {
            // Update Title & Phase
            const phase = getPhaseName(currentViewWeek, currentTrainingWeeks);
            document.getElementById('displayWeek').innerText = `Week ${currentViewWeek}`;
            document.getElementById('displayPhase').innerText = `${phase} Phase`;

            // Render Grid
            renderDailyGrid(currentViewWeek);
        }

        function getPhaseName(w, t) {
            let taper=2, peak=Math.max(2, Math.floor(t*0.25)), build=Math.max(3, Math.floor(t*0.35)), base=t-(taper+peak+build);
            if(base<1) base=1;
            if(w<=base) return "Base"; if(w<=base+build) return "Build"; if(w<=base+build+peak) return "Peak"; return "Taper";
        }

        function renderDailyGrid(wNum) {
            const grid = document.getElementById('dailyGrid'); grid.innerHTML = "";
            const phase = getPhaseName(wNum, currentTrainingWeeks);
            const today = new Date(); 
            // ì‹¤ì œ ì£¼ì°¨ ê³„ì‚° ë¡œì§ (ê°„ë‹¨í•˜ê²Œ ì˜¤ëŠ˜=1ì£¼ì°¨ ì›”ìš”ì¼ ê°€ì •, ì‹¤ì œ ì•±ì—ì„  ì‹œì‘ì¼ ë³€ìˆ˜ í•„ìš”)
            const startDay = new Date(today); startDay.setDate(today.getDate() + (wNum-1)*7);
            
            const days = ['ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† ','ì¼'];
            const plans = getWeeklyPlan(wNum, phase, userFreq, globalTargetDist);

            plans.forEach((plan, idx) => {
                const date = new Date(startDay); date.setDate(startDay.getDate() + idx);
                const dStr = `${date.getMonth()+1}.${date.getDate()} (${days[idx]})`;
                const isToday = (wNum === 1 && idx === 0); // Demo: 1ì£¼ì°¨ ì²«ë‚ ë§Œ ì˜¤ëŠ˜

                const card = document.createElement('div');
                card.className = `day-card type-${plan.type} ${isToday ? 'today' : ''}`;
                // Store the plan index or data to use in showDetail
                card.onclick = (e) => {
                    // Remove active from all
                    document.querySelectorAll('.day-card').forEach(c => c.classList.remove('active'));
                    // Add active to current
                    e.currentTarget.classList.add('active');
                    showDetail(plan);
                };
                
                let badge = "";
                if(isToday) badge = `<span class="day-badge">TODAY</span>`;
                else if(plan.type === 'Rest') badge = `<span class="day-badge">REST</span>`;

                card.innerHTML = `
                    <div class="day-header">
                        <div class="day-date">${dStr}</div>
                        ${badge}
                    </div>
                    <span class="day-icon">${plan.icon}</span>
                    <div class="day-title">${plan.title}</div>
                    <div class="day-desc">${plan.desc}</div>
                `;
                grid.appendChild(card);
            });
            
            // Auto select first card
            const firstCard = grid.firstElementChild;
            if(firstCard) {
                firstCard.classList.add('active');
                showDetail(plans[0]);
            }
        }

        function showDetail(plan) {
            document.getElementById('detailBox').style.display = 'block';
            document.getElementById('dIcon').innerText = plan.icon;
            document.getElementById('dTitle').innerText = plan.title;
            document.getElementById('dSubtitle').innerText = plan.desc;
            document.getElementById('dWhy').innerText = plan.why;
            document.getElementById('dHow').innerHTML = plan.how; // Using innerHTML for rich text
            document.getElementById('dCaution').innerText = plan.caution;
        }

        // ... (getWeeklyPlan modified to support rich HTML 'how') ...
        function getWeeklyPlan(week, phase, freq, distType) {
            const isFull = distType > 30; const isHalf = distType > 15 && distType < 30;
            let p = [
                { type: 'Rest', title: 'íœ´ì‹', icon: 'ğŸ›Œ' },
                { type: 'Easy', title: 'Easy Run', icon: 'ğŸƒâ€â™‚ï¸' },
                { type: 'Wed', title: 'ë³´ê°•/Easy', icon: 'ğŸ§˜' },
                { type: 'Speed', title: 'Interval', icon: 'âš¡' },
                { type: 'Rest', title: 'íœ´ì‹', icon: 'ğŸ›Œ' },
                { type: 'Long', title: 'LSD', icon: 'ğŸ”ï¸' },
                { type: 'Recovery', title: 'Recovery', icon: 'ğŸ©¹' }
            ];
            if(freq === 3) { p[2] = { type: 'Rest', title: 'íœ´ì‹', icon: 'ğŸ›Œ' }; p[6] = { type: 'Rest', title: 'íœ´ì‹', icon: 'ğŸ›Œ' }; }
            else if(freq >= 5) { p[2] = { type: 'Medium', title: 'Steady Run', icon: 'ğŸ' }; }

            return p.map(d => {
                let desc="", tag="", why="", how="", caution="";
                
                if(d.type === 'Rest') { 
                    desc = "ì™„ì „ íœ´ì‹"; tag = "Recovery"; 
                    why = "ê·¼ìœ¡ íšŒë³µ ë° ì´ˆê³¼ë³´ìƒì„ ìœ ë„í•˜ëŠ” ë‚ ì…ë‹ˆë‹¤."; 
                    how = `<ul><li>ì™„ì „í•œ íœ´ì‹ì„ ì·¨í•˜ê±°ë‚˜ ê°€ë²¼ìš´ í¼ë¡¤ëŸ¬ ë§ˆì‚¬ì§€ë§Œ ìˆ˜í–‰í•˜ì„¸ìš”.</li><li>ìˆ˜ë©´ ì‹œê°„ì„ í‰ì†Œë³´ë‹¤ 30ë¶„ ëŠ˜ë¦¬ì„¸ìš”.</li></ul>`; 
                    caution = "ë³´ê°•ìš´ë™ë„ ê¸ˆì§€. ê·¼ìœ¡ì´ ì„±ì¥í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤."; 
                }
                else if(d.type === 'Easy') {
                    let dkm = isFull ? (phase==='Peak'?'10km':'8km') : '6km';
                    desc = `ì¡°ê¹… ${dkm} @ ${userPaces.easy}`;
                    tag = "Zone 2"; 
                    why = "ìœ ì‚°ì†Œ ë² ì´ìŠ¤ êµ¬ì¶• ë° í¼ êµì •"; 
                    how = `<ul>
                            <li><strong>ì›Œë°ì—…:</strong> 10ë¶„ ê±·ê¸° ë° ë™ì  ìŠ¤íŠ¸ë ˆì¹­</li>
                            <li><strong>ë³¸ìš´ë™:</strong> ${dkm}ë¥¼ <strong>${userPaces.easy}</strong> í˜ì´ìŠ¤ë¡œ í¸ì•ˆí•˜ê²Œ ì£¼í–‰. ì˜† ì‚¬ëŒê³¼ ëŒ€í™”ê°€ ê°€ëŠ¥í•´ì•¼ í•¨.</li>
                            <li><strong>ì¿¨ë‹¤ìš´:</strong> 5ë¶„ ê±·ê¸° + ì •ì  ìŠ¤íŠ¸ë ˆì¹­</li>
                           </ul>`; 
                    caution = "ì†ë„ ìš•ì‹¬ ê¸ˆì§€. í˜ì´ìŠ¤ë¥¼ ë„˜ì–´ê°€ë©´ í›ˆë ¨ ì‹¤íŒ¨ì…ë‹ˆë‹¤.";
                } 
                else if(d.type === 'Medium') {
                    let dkm = isFull ? (phase==='Peak'?'15km':'12km') : '10km';
                    desc = `ì§€ì†ì£¼ ${dkm} @ ${userPaces.steady}`;
                    tag = "Aerobic"; 
                    why = "ì£¼ì¤‘ ë§ˆì¼ë¦¬ì§€ ì ë¦½ ë° ê·¼ì§€êµ¬ë ¥ í–¥ìƒ"; 
                    how = `<ul>
                            <li><strong>ì›Œë°ì—…:</strong> 1km ì•„ì£¼ ì²œì²œíˆ ì¡°ê¹…</li>
                            <li><strong>ë³¸ìš´ë™:</strong> ${dkm}ë¥¼ <strong>${userPaces.steady}</strong> í˜ì´ìŠ¤ë¡œ ì¼ì •í•˜ê²Œ ìœ ì§€. ííŠ¸ëŸ¬ì§€ì§€ ì•ŠëŠ” ìì„¸ì— ì§‘ì¤‘.</li>
                            <li><strong>ì¿¨ë‹¤ìš´:</strong> 1km ê±·ê¸°</li>
                           </ul>`; 
                    caution = "ë‚´ì¼ í¬ì¸íŠ¸ í›ˆë ¨ì„ ìœ„í•´ ì—ë„ˆì§€ë¥¼ 80%ë§Œ ì“°ì„¸ìš”.";
                } 
                else if(d.type === 'Speed') {
                    if(phase === 'Base') {
                        d.title = "Fartlek"; d.icon = "ğŸ’¨"; desc = "40ë¶„ ë³€ì†ì£¼"; tag = "Zone 3"; 
                        why = "ì‹¬íì§€êµ¬ë ¥ ìê·¹ ë° ìŠ¤í”¼ë“œ ê°ê° ìµíˆê¸°"; 
                        how = `<ul>
                                <li><strong>ì›Œë°ì—…:</strong> 15ë¶„ ì¡°ê¹… (ëª¸ì— ì—´ ë‚´ê¸°)</li>
                                <li><strong>ë³¸ìš´ë™:</strong> [3ë¶„ ì¡°ê¹… + 1ë¶„ ì§ˆì£¼(80% ê°•ë„)] x 8ì„¸íŠ¸ ë°˜ë³µ</li>
                                <li><strong>ì¿¨ë‹¤ìš´:</strong> 10ë¶„ ì•„ì£¼ ëŠë¦° ì¡°ê¹…</li>
                               </ul>`; 
                        caution = "ì§ˆì£¼ ì‹œ ìƒì²´ê°€ ë’¤ë¡œ ì –í˜€ì§€ì§€ ì•Šê²Œ ì£¼ì˜í•˜ì„¸ìš”.";
                    } else {
                        d.title = "Threshold"; d.icon = "ğŸ”¥";
                        let tDist = isFull ? (phase==='Peak'?'12km':'10km') : '6km';
                        desc = `í…œí¬ëŸ° ${tDist} @ ${userPaces.threshold}`;
                        tag = "Zone 4"; 
                        why = "ì –ì‚° ì—­ì¹˜(LT) í–¥ìƒ - ì§€ì¹˜ì§€ ì•ŠëŠ” ê³ ì† ì£¼í–‰ ëŠ¥ë ¥"; 
                        how = `<ul>
                                <li><strong>ì›Œë°ì—…:</strong> 2km ì¡°ê¹… + ì§ˆì£¼ 100m x 3íšŒ</li>
                                <li><strong>ë³¸ìš´ë™:</strong> ${tDist}ë¥¼ <strong>${userPaces.threshold}</strong> í˜ì´ìŠ¤ë¡œ ì§€ì† ì£¼í–‰. (ë§¤ìš° í˜ë“¦)</li>
                                <li><strong>ì¿¨ë‹¤ìš´:</strong> 2km ì•„ì£¼ ëŠë¦° ì¡°ê¹…</li>
                               </ul>`; 
                        caution = "í˜ì´ìŠ¤ê°€ ì³ì§€ì§€ ì•Šê²Œ ì§‘ì¤‘í•˜ì„¸ìš”. ì´ í›ˆë ¨ì´ ê¸°ë¡ì„ ë‹¨ì¶•ì‹œí‚µë‹ˆë‹¤.";
                    }
                } 
                else if(d.type === 'Long') {
                    let lDist = '10km';
                    if(isFull) lDist = phase==='Base'?'20km':(phase==='Build'?'25km':(phase==='Peak'?'32km':'15km'));
                    else if(isHalf) lDist = phase==='Peak'?'18km':'12km';
                    desc = `LSD ${lDist}`; tag = "Endurance"; 
                    why = "ì§€ë°© ëŒ€ì‚¬ ëŠ¥ë ¥ ê·¹ëŒ€í™” ë° ì‹¬ë¦¬ì  ê±°ë¦¬ê° ê·¹ë³µ"; 
                    how = `<ul>
                            <li><strong>ì¤€ë¹„:</strong> ì—ë„ˆì§€ì ¤ 1-2ê°œ, ë¬¼ ì¤€ë¹„</li>
                            <li><strong>ë³¸ìš´ë™:</strong> ${lDist}ë¥¼ <strong>${userPaces.easy}</strong> í˜ì´ìŠ¤ë¡œ ë©ˆì¶”ì§€ ì•Šê³  ë‹¬ë¦¬ê¸°.</li>
                            <li><strong>íŒ:</strong> 5kmë§ˆë‹¤ ê¸‰ìˆ˜ ì—°ìŠµì„ ë³‘í–‰í•˜ì„¸ìš”.</li>
                           </ul>`; 
                    caution = "í˜ì´ìŠ¤ê°€ ë¹¨ë¼ì§€ë©´ í›„ë°˜ì— í¼ì§‘ë‹ˆë‹¤. ì²œì²œíˆ ê°€ëŠ” ê²ƒì´ ê¸°ìˆ ì…ë‹ˆë‹¤.";
                } 
                else if(d.type === 'Recovery') {
                    desc = `íšŒë³µ ì¡°ê¹… 5km @ ${userPaces.recovery}`; tag = "Zone 1"; 
                    why = "í˜ˆë¥˜ëŸ‰ ì¦ê°€ë¥¼ í†µí•œ í”¼ë¡œ ë¬¼ì§ˆ(ì –ì‚°) ì œê±°"; 
                    how = `<ul>
                            <li><strong>ë°©ë²•:</strong> <strong>${userPaces.recovery}</strong> í˜ì´ìŠ¤ë¡œ ì‚°ì±…í•˜ë“¯ ê°€ë³ê²Œ ëœë‹ˆë‹¤.</li>
                            <li>ê±·ëŠ” ê²ƒë³´ë‹¤ ì•„ì£¼ ì¡°ê¸ˆ ë¹ ë¥¸ ì •ë„ë©´ ì¶©ë¶„í•©ë‹ˆë‹¤.</li>
                           </ul>`; 
                    caution = "í›ˆë ¨ì´ ì•„ë‹™ë‹ˆë‹¤. íœ´ì‹ì˜ ì—°ì¥ì„ ì…ë‹ˆë‹¤.";
                }
                return { ...d, desc, tag, why, how, caution };
            });
        }
    </script>
</body>
</html>
